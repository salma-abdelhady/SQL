SELECT V.customer_id, COUNT(V.visit_id) AS count_no_trans
FROM Visits as V
LEFT JOIN Transactions as T
USING(visit_id)
WHERE T.amount is null
GROUP BY V.customer_id;
