SELECT user_id, spend, transaction_date
FROM (SELECT user_id, spend,transaction_date, RANK() OVER (PARTITION BY user_id 
ORDER BY transaction_date) AS rank_
FROM transactions
) AS sub
WHERE rank_ = 3;
